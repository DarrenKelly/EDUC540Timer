<!DOCTYPE html>
<html>
  <head>
    <title>Timing App</title>
    <style>
      body {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start; /* Align items to the top */
        height: 100vh;
        margin: 0;
        font-family: "Roboto", sans-serif;
      }
      button {
        padding: 40px 80px; /* Increased padding */
        margin: 15px; /* Increased margins */
        font-size: 24px; /* Increased font size */
        border: none;
        border-radius: 5px;
        cursor: pointer;
        -webkit-user-select: none;
        -moz-user-select: none;
        -ms-user-select: none;
        user-select: none;
      }
      .timer {
        font-size: 30px; /* Increased font size */
        margin-bottom: 10px; /* Increased margin */
      }
      .timer-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin: 20px; /* Increased margins */
      }
      .side-by-side {
        display: flex;
        flex-direction: row;
      }
      #startStop.start {
        background-color: lightgreen;
      }
      #startStop.stop {
        background-color: lightcoral;
      }
      #boysButton {
        background-color: lightblue;
      }
      #girlsButton {
        background-color: pink;
      }
      #tableContainer {
        height: 40vh;
        overflow-y: auto;
        width: 90vw;
        margin-top: 20px;
      }
      table {
        width: 100%;
        border-collapse: collapse;
      }
      th,
      td {
        border: 1px solid black;
        padding: 10px;
        text-align: left;
      }
      th {
        background-color: navy;
        color: white;
      }
      .boysRow {
        background-color: lightblue;
      }
      .girlsRow {
        background-color: pink;
      }
      /* style the totals at the bottom */
      p {
        font-size: 20px;
        margin: 10px;
      }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Roboto:wght@400&display=swap"
      rel="stylesheet"
    />
  </head>
  <body>
    <div class="timer-container">
      <div id="mainTimer" class="timer">00:00:00</div>
      <button id="startStop" class="start">Start</button>
    </div>

    <div class="side-by-side">
      <div class="timer-container">
        <div id="boysTimer" class="timer">00:00:00</div>
        <button id="boysButton">Boys</button>
      </div>

      <div class="timer-container">
        <div id="girlsTimer" class="timer">00:00:00</div>
        <button id="girlsButton">Girls</button>
      </div>
    </div>
    <div id="tableContainer">
      <table>
        <thead>
          <tr>
            <th>Context</th>
            <th>Start Time</th>
            <th>Stop Time</th>
            <th>Duration</th>
          </tr>
        </thead>
        <tbody id="dataTable"></tbody>
      </table>
    </div>

    <script>
      let mainTimerInterval;
      let boysTimerInterval;
      let girlsTimerInterval;
      let mainTime = 0;
      let boysTime = 0;
      let girlsTime = 0;
      let mainRunning = false;
      let boysAttentionStartTime;
      let girlsAttentionStartTime;
      let totalBoysDuration = 0;
      let totalGirlsDuration = 0;

      function formatTime(time) {
        const hours = Math.floor(time / 3600);
        const minutes = Math.floor((time % 3600) / 60);
        const seconds = time % 60;
        return `${String(hours).padStart(2, "0")}:${String(minutes).padStart(
          2,
          "0"
        )}:${String(seconds).padStart(2, "0")}`;
      }

      function updateMainTimer() {
        mainTime++;
        document.getElementById("mainTimer").textContent = formatTime(mainTime);
      }

      function updateBoysTimer() {
        boysTime++;
        document.getElementById("boysTimer").textContent = formatTime(boysTime);
      }

      function updateGirlsTimer() {
        girlsTime++;
        document.getElementById("girlsTimer").textContent =
          formatTime(girlsTime);
      }

      function resetTimers() {
        mainTime = 0;
        boysTime = 0;
        girlsTime = 0;
        document.getElementById("mainTimer").textContent = "00:00:00";
        document.getElementById("boysTimer").textContent = "00:00:00";
        document.getElementById("girlsTimer").textContent = "00:00:00";
      }

      document
        .getElementById("startStop")
        .addEventListener("click", function () {
          if (mainRunning) {
            clearInterval(mainTimerInterval);
            this.textContent = "Start";
            this.classList.remove("stop");
            this.classList.add("start");
            mainRunning = false;
            const boysTotalDisplay = document.createElement("p");
            const girlsTotalDisplay = document.createElement("p");
            boysTotalDisplay.textContent =
              "Total Boys Duration: " + formatTime(totalBoysDuration);
            girlsTotalDisplay.textContent =
              "Total Girls Duration: " + formatTime(totalGirlsDuration);
            document.body.appendChild(boysTotalDisplay);
            document.body.appendChild(girlsTotalDisplay);
          } else {
            resetTimers();
            totalBoysDuration = 0;
            totalGirlsDuration = 0;
            mainTimerInterval = setInterval(updateMainTimer, 1000);
            this.textContent = "Stop";
            this.classList.remove("start");
            this.classList.add("stop");
            mainRunning = true;
          }
        });

      document
        .getElementById("boysButton")
        .addEventListener("mousedown", boysStart);
      document
        .getElementById("boysButton")
        .addEventListener("mouseup", boysEnd);
      document
        .getElementById("boysButton")
        .addEventListener("touchstart", boysStart);
      document
        .getElementById("boysButton")
        .addEventListener("touchend", boysEnd);

      function boysStart(e) {
        e.preventDefault();
        boysAttentionStartTime = mainTime;
        if (!boysTimerInterval) {
          boysTimerInterval = setInterval(updateBoysTimer, 1000);
        }
      }

      function boysEnd(e) {
        e.preventDefault();
        clearInterval(boysTimerInterval);
        boysTimerInterval = null;
        const duration = mainTime - boysAttentionStartTime;
        totalBoysDuration += duration;
        const table = document.getElementById("dataTable");
        const row = table.insertRow();
        row.classList.add("boysRow");
        const cell1 = row.insertCell();
        const cell2 = row.insertCell();
        const cell3 = row.insertCell();
        const cell4 = row.insertCell();
        cell1.textContent = "Talking to Boys";
        cell2.textContent = formatTime(boysAttentionStartTime);
        cell3.textContent = formatTime(mainTime);
        cell4.textContent = formatTime(duration);
        window.scrollTo(0, 0); // Scroll to the top of the page
      }

      document
        .getElementById("girlsButton")
        .addEventListener("mousedown", girlsStart);
      document
        .getElementById("girlsButton")
        .addEventListener("mouseup", girlsEnd);
      document
        .getElementById("girlsButton")
        .addEventListener("touchstart", girlsStart);
      document
        .getElementById("girlsButton")
        .addEventListener("touchend", girlsEnd);

      function girlsStart(e) {
        e.preventDefault();
        girlsAttentionStartTime = mainTime;
        if (!girlsTimerInterval) {
          girlsTimerInterval = setInterval(updateGirlsTimer, 1000);
        }
      }

      function girlsEnd(e) {
        e.preventDefault();
        clearInterval(girlsTimerInterval);
        girlsTimerInterval = null;
        const duration = mainTime - girlsAttentionStartTime;
        totalGirlsDuration += duration;
        const table = document.getElementById("dataTable");
        const row = table.insertRow();
        row.classList.add("girlsRow");
        const cell1 = row.insertCell();
        const cell2 = row.insertCell();
        const cell3 = row.insertCell();
        const cell4 = row.insertCell();
        cell1.textContent = "Talking to Girls";
        cell2.textContent = formatTime(girlsAttentionStartTime);
        cell3.textContent = formatTime(mainTime);
        cell4.textContent = formatTime(duration);
        window.scrollTo(0, 0); // Scroll to the top of the page
      }
    </script>
  </body>
</html>
